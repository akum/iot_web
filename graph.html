<head>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
	<title>IoT Home</title>
	<script src="http://code.highcharts.com/highcharts.js"></script>
	<script src="http://ajax.googleapis.com/ajax/libs/jquery/1.8.2/jquery.min.js"></script>
	<script type="text/javascript">
		$(document).ready(function() {
			inputMax = location.search.split('max=')[1]
			options = {
				title: {text: 'Home Temperature'},
				xAxis: {labels: {enabled: false}},
				yAxis: {title: {text: 'Celcius'}},
				series: [],
				chart: {
					zoomType: 'x',
					renderTo: 'container'
				},
				tooltip: {
					formatter: function() {
						return '<b>'+ this.series.name +'</b><br/>'+
						this.x +' = '+ this.y
					}
				}
			}

			options2 = JSON.parse(JSON.stringify(options));
			options2.chart.renderTo = "container2";
			options2.chart.type = "area";
			options2.title.text= "Heat Level";

			if(typeof inputMax === 'undefined') inputMax = "100";
			document.getElementById("max").value=inputMax;

			tables="Chambre,Chambre2,SalleBain,Salon";
			$.getJSON("data.php?name="+tables+"&max="+inputMax, function(json){
				options.xAxis.categories = json[0]['data'];
				options.series = json.slice(1);
				chart = new Highcharts.Chart(options);
			});
			tables="HChambre,HChambre2,HSalleBain,HSalon,Exterieur";
			$.getJSON("data.php?name="+tables+"&max="+inputMax, function(json){
				options2.xAxis.categories = json[0]['data'];
				options2.series = json.slice(1);
				chart2 = new Highcharts.Chart(options2);
			});
		});
	</script>
</head>
<body>
	<div id="container" style="margin: 0 auto"></div>
	<div id="container2" style="margin: 0 auto"></div>
	<input type=button value='Refresh' onclick="refresh()" id="refresh">
	Max entries: <input type="text" id="max" onkeypress="handle(event)"><br>
	<script>
		function refresh() {
			url = document.getElementById("max").value;
			window.location.href = "graph.html?max="+url;
		}
		function handle(e){
			if(e.keyCode === 13){
				$("#refresh").click();
			}
			return false;
		}
	</script>
</body>
